{"ast":null,"code":"import _slicedToArray from\"/home/wws/Desktop/todo-application/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import\"./Post.css\";import Modal from'./../../common/Modal/Modal';import Sidebar from\"../../components/Sidebar/Sidebar\";import Axios from\"axios\";import{AuthContext}from'../../context/Auth';function Post(props){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModal=_useState2[0],setShowModal=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showDetails=_useState4[0],setShowDetails=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),postTitle=_useState6[0],setPostTitle=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),postDescription=_useState8[0],setPostDescription=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),scheduleDate=_useState10[0],setScheduleDate=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),formComplete=_useState12[0],setFormComplete=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),formIncompleteError=_useState14[0],setFormIncompleteError=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),postName=_useState16[0],setPostName=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),postDetail=_useState18[0],setPostDetail=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),postDate=_useState20[0],setPostDate=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),postData=_useState22[0],setPostData=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),isPostAdded=_useState24[0],setIsPostAdded=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isPostDelete=_useState26[0],setIsPostDelete=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),isPostEdited=_useState28[0],setIsPostEdited=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),editDetails=_useState30[0],setEditDetails=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),postId=_useState32[0],setPostId=_useState32[1];var postTitles=React.useRef();var postDescriptions=React.useRef();var scheduleDates=React.useRef();var userId=currentUser.uid;// to Hide past date\nvar today=new Date();var month,day=null;if(today.getMonth()<10||today.getDate()<10){month=\"0\"+(today.getMonth()+1);day=\"0\"+today.getDate();}var date=today.getFullYear()+\"-\"+month+\"-\"+day;useEffect(function(){setIsPostAdded(false);setIsPostDelete(false);setIsPostEdited(false);getPostData(currentUser.email);},[isPostAdded,isPostDelete,isPostEdited,currentUser]);var getPostData=function getPostData(email){Axios.get(\"https://react-crud-e02cf.firebaseio.com/post/\".concat(userId,\".json\")).then(function(response){setPostData(response.data);// setPostData(Object.entries(response.data).filter((e)=>(e.user === email)));\n// console.log(response);\n}).catch(function(error){return console.log(error);});};//  to Add and Edit cardData in DB\nvar handleAddPostData=function handleAddPostData(e){//   check if all input is taken\nif(postTitles.current.value.length===0||postDescriptions.current.value.length===0||scheduleDates.current.value.length===0){setFormComplete(false);setFormIncompleteError(true);}else{// if user wants to edit then put request is used\nif(editDetails){Axios.put(\"https://react-crud-e02cf.firebaseio.com/post/\".concat(userId,\"/\").concat(postId,\".json\"),{postName:postName===\"\"?postTitle:postName,postDetail:postDetail===\"\"?postDescription:postDetail,postDate:postDate===\"\"?scheduleDate:postDate,user:currentUser.email}).then(function(response){alert(\"post edited succesfully\");setIsPostEdited(true);}).catch(function(error){return console.log(\"Error in editDetails\"+error);});}//  if user wants to add a new card\nelse{Axios.post(\"https://react-crud-e02cf.firebaseio.com/post/\".concat(userId,\".json\"),{postName:postName,postDetail:postDetail,postDate:postDate,user:currentUser.email}).then(function(response){alert(\"post added succesfully\");setIsPostAdded(true);}).catch(function(error){return console.log(\"Error\"+error);});}setShowModal(false);setEditDetails(false);setPostName(\"\");setPostDetail(\"\");setPostDate(\"\");}};// on click of card this function shows details\nvar onPostClick=function onPostClick(postTitle,postDescription,scheduleDate,postId,e){setShowDetails(true);setPostTitle(postTitle);setPostDescription(postDescription);setScheduleDate(scheduleDate);setPostId(postId);};// handles edit button click\nvar handleEdit=function handleEdit(e){setShowDetails(false);setShowModal(true);setEditDetails(true);};// handles archive on card archive click\nvar handleDelete=function handleDelete(postId,e){if(window.confirm(\"Are you sure you want to delete the Post?\")){Axios.delete(\"https://react-crud-e02cf.firebaseio.com/post/\".concat(userId,\"/\").concat(postId,\".json\")).then(function(response){alert(\"post deleted succesfully\");setIsPostDelete(true);}).catch(function(error){return console.log(\"Error\"+error);});}};var modalCloseHandler=function modalCloseHandler(){setShowModal(false);setEditDetails(false);};var showmodalCloseHandler=function showmodalCloseHandler(){setShowDetails(false);};//modal of Add and Edit Card\nvar modalContent=showModal?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container py-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 text-left\"},/*#__PURE__*/React.createElement(\"h3\",null,editDetails?'Edit Post':'Add Post'),formIncompleteError?/*#__PURE__*/React.createElement(\"p\",{style:{color:'red'}},\"Kindly complete the form before adding Column\"):null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"postTitle\"},\"Post Title\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"post_title\",defaultValue:editDetails?postTitle:\"\",placeholder:\"Enter a post title\",ref:postTitles,onChange:function onChange(event){return setPostName(event.target.value);},className:\"form-control\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"postDescription\"},\"Post Description\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"post_description\",defaultValue:editDetails?postDescription:\"\",placeholder:\"Enter a post Description\",ref:postDescriptions,onChange:function onChange(event){return setPostDetail(event.target.value);},className:\"form-control\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"schedule\"},\"Schedule Date\"),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",id:\"schedule_date\",min:date,defaultValue:editDetails?scheduleDate:\"\",ref:scheduleDates,onChange:function onChange(event){return setPostDate(event.target.value);},className:\"form-control\"})),/*#__PURE__*/React.createElement(\"button\",{disabled:formComplete,className:\"btn btn-info\",onClick:handleAddPostData},editDetails?'Edit Post':'Add Post'))))):null;//modal of show card details\nvar showmodalContent=showDetails?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container my-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"text-left\"},\"View Post\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",id:\"editBtn\",className:\"btn btn-info\",onClick:handleEdit},\"Edit Post\")),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"text-left my-4\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Post Title\"),/*#__PURE__*/React.createElement(\"h6\",null,postTitle)),/*#__PURE__*/React.createElement(\"div\",{className:\"text-left my-4\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Post Description\"),/*#__PURE__*/React.createElement(\"h6\",null,postDescription)),/*#__PURE__*/React.createElement(\"div\",{className:\"text-left my-4\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Post Date\"),/*#__PURE__*/React.createElement(\"h6\",null,scheduleDate)))))):null;return/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper d-flex align-items-stretch\"},/*#__PURE__*/React.createElement(Sidebar,null),/*#__PURE__*/React.createElement(\"div\",{className:\"container py-3 post-data\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Posts\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-dark mt-4\",onClick:function onClick(){return setShowModal(true);}},\"Add Post\"),/*#__PURE__*/React.createElement(\"div\",{className:\"post-table my-5\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped table-hover table-dark\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Post Title\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Post Description\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Schedule date\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Action\"))),/*#__PURE__*/React.createElement(\"tbody\",null,postData?Object.entries(postData).map(function(item){return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{key:item[0]},item[1].postName),/*#__PURE__*/React.createElement(\"td\",null,item[1].postDetail),/*#__PURE__*/React.createElement(\"td\",null,item[1].postDate),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{id:item[0],value:item[1].postName,onClick:function onClick(e){return onPostClick(item[1].postName,item[1].postDetail,item[1].postDate,item[0],e);},className:\"btn btn-success btn-sm\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-eye\",\"aria-hidden\":\"true\"})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",id:item[0],onClick:function onClick(e){return handleDelete(item[0],e);},className:\"btn btn-danger btn-sm ml-2\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-trash\",\"aria-hidden\":\"true\"}))));}):/*#__PURE__*/React.createElement(\"span\",{className:\"noTaskAdded p-5\"},\"No tasks added\")))),/*#__PURE__*/React.createElement(\"br\",null),showModal&&/*#__PURE__*/React.createElement(Modal,{content:modalContent,close:modalCloseHandler}),showDetails&&/*#__PURE__*/React.createElement(Modal,{content:showmodalContent,close:showmodalCloseHandler})));}export default Post;","map":{"version":3,"sources":["/home/wws/Desktop/todo-application/src/pages/Posts/Post.js"],"names":["React","useState","useEffect","useContext","Modal","Sidebar","Axios","AuthContext","Post","props","currentUser","showModal","setShowModal","showDetails","setShowDetails","postTitle","setPostTitle","postDescription","setPostDescription","scheduleDate","setScheduleDate","formComplete","setFormComplete","formIncompleteError","setFormIncompleteError","postName","setPostName","postDetail","setPostDetail","postDate","setPostDate","postData","setPostData","isPostAdded","setIsPostAdded","isPostDelete","setIsPostDelete","isPostEdited","setIsPostEdited","editDetails","setEditDetails","postId","setPostId","postTitles","useRef","postDescriptions","scheduleDates","userId","uid","today","Date","month","day","getMonth","getDate","date","getFullYear","getPostData","email","get","then","response","data","catch","error","console","log","handleAddPostData","e","current","value","length","put","user","alert","post","onPostClick","handleEdit","handleDelete","window","confirm","delete","modalCloseHandler","showmodalCloseHandler","modalContent","color","event","target","showmodalContent","Object","entries","map","item"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport  \"./Post.css\";\nimport Modal from './../../common/Modal/Modal';\nimport Sidebar from \"../../components/Sidebar/Sidebar\";\nimport Axios from \"axios\";\nimport { AuthContext } from '../../context/Auth';\n\n\nfunction Post(props) {\n  const { currentUser } = useContext(AuthContext);\n\n  const [showModal, setShowModal] = useState(false);\n  const [showDetails, setShowDetails] = useState(false);\n  const [postTitle, setPostTitle] = useState(\"\");\n  const [postDescription, setPostDescription] = useState(\"\");\n  const [scheduleDate, setScheduleDate] = useState(\"\");\n  const [formComplete, setFormComplete] = useState(false);\n  const [formIncompleteError, setFormIncompleteError] = useState(false);\n\n  const [postName, setPostName] = useState(\"\");\n  const [postDetail, setPostDetail] = useState(\"\");\n  const [postDate, setPostDate] = useState(\"\");\n\n  const [postData, setPostData] = useState(\"\");\n  const [isPostAdded, setIsPostAdded] = useState(false);\n  const [isPostDelete, setIsPostDelete] = useState(false);\n  const [isPostEdited, setIsPostEdited] = useState(false);\n\n  const [editDetails, setEditDetails] = useState(false);\n  const [postId, setPostId] = useState(\"\");\n\n  const postTitles  = React.useRef();\n  const postDescriptions  = React.useRef();\n  const scheduleDates  = React.useRef();\n\n  const userId = currentUser.uid;\n \n    // to Hide past date\n    var today = new Date();\n    var month,\n      day = null;\n    if (today.getMonth() < 10 || today.getDate() < 10) {\n      month = \"0\" + (today.getMonth() + 1);\n      day = \"0\" + today.getDate();\n    }\n    var date = today.getFullYear() + \"-\" + month + \"-\" + day;\n\n    useEffect(() => {\n      setIsPostAdded(false);\n      setIsPostDelete(false);\n      setIsPostEdited(false);\n      getPostData(currentUser.email);\n    }, [isPostAdded, isPostDelete, isPostEdited, currentUser]);\n\n    const getPostData = (email) => {\n      Axios\n      .get(`https://react-crud-e02cf.firebaseio.com/post/${userId}.json`)\n      .then((response) => {\n        setPostData(response.data)\n        // setPostData(Object.entries(response.data).filter((e)=>(e.user === email)));\n        // console.log(response);\n      })\n      .catch((error) => console.log(error));\n  };\n  \n//  to Add and Edit cardData in DB\nconst handleAddPostData = (e) => {\n  //   check if all input is taken\n  if(postTitles.current.value.length === 0 || postDescriptions.current.value.length === 0  || scheduleDates.current.value.length === 0 ){\n    setFormComplete(false);\n    setFormIncompleteError(true);\n  } else {\n    // if user wants to edit then put request is used\n    if (editDetails) {\n      Axios\n      .put(`https://react-crud-e02cf.firebaseio.com/post/${userId}/${postId}.json`,\n        {\n          postName: postName === \"\" ? postTitle : postName,\n          postDetail: postDetail === \"\" ? postDescription : postDetail,\n          postDate: postDate === \"\" ? scheduleDate : postDate,\n          user: currentUser.email,\n        }\n      )\n        .then((response) => {\n          alert(\"post edited succesfully\");\n          setIsPostEdited(true);\n        })\n        .catch((error) => console.log(\"Error in editDetails\" + error));\n    }\n    //  if user wants to add a new card\n    else {\n      Axios\n      .post(`https://react-crud-e02cf.firebaseio.com/post/${userId}.json`,\n        {\n          postName: postName,\n          postDetail: postDetail,\n          postDate: postDate,\n          user: currentUser.email,\n        }\n      )\n        .then((response) => {\n          alert(\"post added succesfully\");\n          setIsPostAdded(true);\n        })\n        .catch((error) => console.log(\"Error\" + error));\n    }\n\n    setShowModal(false);\n    setEditDetails(false);\n\n    setPostName(\"\");\n    setPostDetail(\"\");\n    setPostDate(\"\");\n  }\n};\n\n  // on click of card this function shows details\n  const onPostClick = (\n    postTitle,\n    postDescription,\n    scheduleDate,\n    postId,\n    e\n  ) => {\n    setShowDetails(true);\n\n    setPostTitle(postTitle);\n    setPostDescription(postDescription);\n    setScheduleDate(scheduleDate);\n    setPostId(postId);\n  };\n\n   // handles edit button click\n const handleEdit = (e) => {\n  setShowDetails(false);\n  setShowModal(true);\n  setEditDetails(true);\n};\n\n\n\n  // handles archive on card archive click\n  const handleDelete = (postId, e) => {\n    if (window.confirm(\"Are you sure you want to delete the Post?\")) {\n    Axios\n    .delete(`https://react-crud-e02cf.firebaseio.com/post/${userId}/${postId}.json`)\n      .then((response) => {\n        alert(\"post deleted succesfully\");\n        setIsPostDelete(true);\n      })\n      .catch((error) => console.log(\"Error\" + error));\n    }\n  };\n\n\n\n  const  modalCloseHandler = () => { setShowModal(false); setEditDetails(false);};\n\n  const  showmodalCloseHandler = () => {setShowDetails(false)};\n\n  //modal of Add and Edit Card\n  let modalContent = showModal ? \n\n  (\n      <>\n    <div className=\"container py-4\">\n      <div className=\"row\">\n        <div className=\"col-md-12 text-left\">\n          <h3>{editDetails ? 'Edit Post' : 'Add Post'}</h3>\n          {formIncompleteError ? <p style={{color : 'red'}}>Kindly complete the form before adding Column</p> : null}\n        <div className=\"form-group\">\n          <label htmlFor=\"postTitle\">Post Title</label>\n          <input type=\"text\" id=\"post_title\" defaultValue={editDetails ? postTitle : \"\"} placeholder=\"Enter a post title\" ref={postTitles} onChange={(event) => setPostName(event.target.value)} className=\"form-control\"/>\n        </div> \n        <div className=\"form-group\">\n          <label htmlFor=\"postDescription\">Post Description</label>\n          <input type=\"text\" id=\"post_description\" defaultValue={editDetails ? postDescription : \"\"} placeholder=\"Enter a post Description\" ref={postDescriptions} onChange={(event) => setPostDetail(event.target.value)} className=\"form-control\"/>\n        </div> \n        <div className=\"form-group\">\n          <label htmlFor=\"schedule\">Schedule Date</label>\n          <input type=\"date\" id=\"schedule_date\" min={date} defaultValue={editDetails ? scheduleDate : \"\"} ref={scheduleDates} onChange={(event) => setPostDate(event.target.value)} className=\"form-control\"/>\n        </div>\n        <button disabled={formComplete} className=\"btn btn-info\" onClick={handleAddPostData}>{editDetails ? 'Edit Post' : 'Add Post'}</button>\n        </div>\n      </div>\n    </div>\n\n  \n      </>\n  )\n  :null;\n\n  //modal of show card details\n  let showmodalContent = showDetails ? \n\n  (\n      <>\n  <div className=\"container my-4\">\n        <div className=\"row\">\n          <div className=\"col-lg-12\">\n          <div className=\"d-flex justify-content-between\">\n            <h2 className=\"text-left\">View Post</h2>\n            <button type=\"button\" id=\"editBtn\" className=\"btn btn-info\" onClick={handleEdit}>Edit Post</button>\n          </div>\n          <hr/>\n          <div className=\"text-left my-4\">\n            <h4>Post Title</h4>\n            <h6>{postTitle}</h6>\n          </div>\n          <div className=\"text-left my-4\">\n            <h4>Post Description</h4>\n            <h6>{postDescription}</h6>\n          </div>\n          <div className=\"text-left my-4\">\n            <h4>Post Date</h4>\n            <h6>{scheduleDate}</h6>\n          </div>\n      </div>\n      </div>\n      </div>\n      </>\n     \n  )\n  :null;\n\n  return (\n    <div className=\"wrapper d-flex align-items-stretch\">\n    <Sidebar />\n    <div className=\"container py-3 post-data\">\n      <h2>Posts</h2>\n      <button className=\"btn btn-dark mt-4\" onClick={() => setShowModal(true)}>Add Post</button>\n      <div className=\"post-table my-5\">\n      <table className=\"table table-striped table-hover table-dark\">\n      <thead>\n        <tr>\n          <th scope=\"col\">Post Title</th>\n          <th scope=\"col\">Post Description</th>\n          <th scope=\"col\">Schedule date</th>\n          <th scope=\"col\">Action</th>\n        </tr>\n      </thead>\n      <tbody>\n      {postData ?\n        Object.entries(postData).map((item) => (\n        <tr>\n          <td key={item[0]}>{item[1].postName}</td>\n          <td>{item[1].postDetail}</td>\n          <td>{item[1].postDate}</td>\n          <td>\n            <button  id={item[0]} value={item[1].postName} onClick={(e) =>\n                  onPostClick(\n                    item[1].postName,\n                    item[1].postDetail,\n                    item[1].postDate,\n                    item[0],\n                    e\n                  )\n                } className=\"btn btn-success btn-sm\"><i className=\"fa fa-eye\" aria-hidden=\"true\"></i></button>\n                <button type=\"button\"  id={item[0]}  onClick={(e) => handleDelete(item[0], e)} className=\"btn btn-danger btn-sm ml-2\"><i className=\"fa fa-trash\" aria-hidden=\"true\"></i></button></td>\n        </tr>\n        ) ) : <span className=\"noTaskAdded p-5\">No tasks added</span>}\n      </tbody>\n    </table>\n      </div>\n        <br />\n        {showModal && (\n        \n            <Modal  \n                content = {modalContent}\n                close = {modalCloseHandler}/> \n        )}\n       \n       {showDetails && (\n        \n        <Modal  \n            content = {showmodalContent}\n            close = {showmodalCloseHandler}/> \n    )}\n\n    </div>\n    </div>\n\n\n   \n)\n}\n\nexport default Post;\n"]},"metadata":{},"sourceType":"module"}